<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.65">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NR1FQ09LP2"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NR1FQ09LP2",{anonymize_ip:!0})</script><title data-react-helmet="true">Understanding BuildContext in Flutter | Damodar Lohani</title><meta data-react-helmet="true" property="og:title" content="Understanding BuildContext in Flutter | Damodar Lohani"><meta data-react-helmet="true" name="description" content="If you have been learning Flutter, you have seen BuildContext everywhere. BuildContext is an important concept in Flutter most developers find hard to understand. Many of even seasoned developers don&#x27;t fully understand what BuildContext is and what it does. Yet it&#x27;s basic and must know for every Flutter developers. Today in this article we will try to understand what BuildContext is and why it is important. Before we understand BuildContext, we must understand widget and widget tree. So let&#x27;s dive into that."><meta data-react-helmet="true" property="og:description" content="If you have been learning Flutter, you have seen BuildContext everywhere. BuildContext is an important concept in Flutter most developers find hard to understand. Many of even seasoned developers don&#x27;t fully understand what BuildContext is and what it does. Yet it&#x27;s basic and must know for every Flutter developers. Today in this article we will try to understand what BuildContext is and why it is important. Before we understand BuildContext, we must understand widget and widget tree. So let&#x27;s dive into that."><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/img/logo.svg"><link rel="stylesheet" href="/styles.46ed3ea3.css">
<link rel="preload" href="/styles.c6487bce.js" as="script">
<link rel="preload" href="/runtime~main.f2f68536.js" as="script">
<link rel="preload" href="/main.364704fe.js" as="script">
<link rel="preload" href="/common.44bbcb76.js" as="script">
<link rel="preload" href="/55.41bd41e7.js" as="script">
<link rel="preload" href="/83f3d26f.0fc53958.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top navbarHideable_3046"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Damodar Lohani"><strong class="navbar__title">Damodar Lohani</strong></a><a class="navbar__item navbar__link" href="/projects">Projects</a><a class="navbar__item navbar__link" href="/talks">Talks</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/contact">Contact</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/lohanidamodar" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Damodar Lohani"><strong class="navbar__title">Damodar Lohani</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/projects">Projects</a></li><li class="menu__list-item"><a class="menu__link" href="/talks">Talks</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/contact">Contact</a></li><li class="menu__list-item"><a href="https://github.com/lohanidamodar" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository"></a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--8 col--offset-2"><article><header><h1 class="margin-bottom--sm blogPostTitle_1mse">Understanding BuildContext in Flutter</h1><div class="margin-vert--md"><time datetime="2021-12-15T00:00:00.000Z" class="blogPostDate_3bQP">December 15, 2021  Â· 6 min read</time></div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><section class="markdown"><p>If you have been learning Flutter, you have seen BuildContext everywhere. BuildContext is an important concept in Flutter most developers find hard to understand. Many of even seasoned developers don&#x27;t fully understand what BuildContext is and what it does. Yet it&#x27;s basic and must know for every Flutter developers. Today in this article we will try to understand what BuildContext is and why it is important. Before we understand BuildContext, we must understand widget and widget tree. So let&#x27;s dive into that.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="widget-tree"></a>Widget Tree<a aria-hidden="true" tabindex="-1" class="hash-link" href="#widget-tree" title="Direct link to heading">#</a></h2><p>In Flutter everything is a widget. Container, text, button, providers everything is virtually a widget. Also, a parent widgets can have one or more child widgets. Flutter applications consists of stack of widgets popularly known as the <strong>widget tree</strong>. In the widget tree we connect parent and child widgets to show their relationship.</p><p>If you have previously worked with frameworks like ReactJS, ViewJS or other component based frameworks, this is very similar. On frontend frameworks we have components, root component from where other components are sacked upon and each component is responsible for a unit of UI. So a ReactJS or ViewJS applications are a tree of components. In Flutter the components are rather called widgets but follows the similar principle. We have a root widget which is responsible for housing other widgets. So there is a parent-child relationship between widgets.</p><p>A widget that renders another widget is a <strong>parent widget</strong> and the widget that is rendered by the parent widget is called the <strong>child widget</strong>. So if we have a root widget called <code>MyApp</code> which is the default in Flutter projects (but you can change it) it becomes the root in our widget tree.</p><p>For example a tree could look like the following.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">            MyApp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          MaterialApp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           Scaffold</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        --------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        |            |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      AppBar        Row</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                     |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            ------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            |                |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          Text             TextButton</span></div></div></div></div></div><p>Here, we have <code>MyApp</code> as the root widget that is parent to all the widgets in the tree. This renders <code>MaterialApp</code> which renders <code>Scaffold</code> that renders <code>AppBar</code> and <code>Row</code>. And finally <code>Row</code> renders <code>Text</code> and <code>TextButton</code>. We can go deeper and look into text and text button widgets but you get the point. So here we can say that <code>MyApp</code> is parent of <code>MaterialApp</code> and <code>Scaffold</code> is parent of both <code>AppBar</code> and <code>Row</code> widgets. Before we move on to understanding build context, keep in mind that every widget in a widget tree are in their own place. They have their own position, siblings, parent and child information. However the widget itself doesn&#x27;t hold any of those information and that is where the BuildContext comes in. So let&#x27;s dive into BuildContext.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="buildcontext"></a>BuildContext<a aria-hidden="true" tabindex="-1" class="hash-link" href="#buildcontext" title="Direct link to heading">#</a></h2><p>From the <a href="https://api.flutter.dev/flutter/widgets/BuildContext-class.html" target="_blank" rel="noopener noreferrer">API docs</a>, BuildContext is a handle to the location of a widget in a widget tree. Every widget in a widget tree has their own unique BuildContext which they receive in their build method. This means that BuildContext of a widget is not same as the BuildContext of the widget returned by the widget from the build method. In our widget tree example above, the BuildContext of MyApp is different from that of MaterialApp and BuildContext of MaterialApp is not the same as the BuildContext of Scaffold. Each widget in the widget tree have their own unique BuildContext.</p><p>If we look into the source code of Flutter, for example into <code>StatelessWidget</code>, we can see a <code>createElement</code> method that creates an instance of <code>StatelessElement</code> passing <code>this</code> widget as parameter. </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-dart codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">// StatelessWidget</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">StatelessElement createElement() =&gt; StatelessElement(this);</span></div></div></div></div></div><p>And if we look into <code>StatelessElement</code>, it passes it&#x27;s own instance to the widgets build method.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-dart codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">class StatelessElement extends ComponentElement {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  StatelessElement(StatelessWidget widget) : super(widget);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Widget build() =&gt; widget.build(this);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><p>If we keep exploring more, we can see that <code>ComponentElement</code> extends <code>Element</code> which implements <code>BuildContext</code> class. So we can see that the element instance is what comes as <code>BuildContext</code> to every widget&#x27;s build method.</p><p>So from this, as every widget in widget tree is created by build method, and the build method receives this BuildContext. This helps the build method to find which widget it is going to draw and to locate the position of the widget to be drawn in the widget tree.</p><p>Also, note that the widgets are only visible to their own BuildContext or to the BuildContext of their parent. That is wy, we can locate the parent widget from a child widget using <code>findAncestorWidgetOfExactType</code> helper method from BuildContext. This method is used to locate a widget of particular type in the widget tree. Going up the widget tree from whichever widget it was called, this method will try to locate the first widget that matches the type passed to the method.</p><p>For example, we have a tree <code>MyApp-&gt; Scaffold -&gt; Row -&gt; Container -&gt; Row -&gt; Text</code>. And we call the following method from the <code>Text</code> widget.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">context.findAncestorWidgetOfExactType(Row)</span></div></div></div></div></div><p>This will traverse up the tree starting from <code>Text</code> widget and stopping when a widget of type <code>Row</code> is located. So, the Row between <code>Text</code> and <code>Container</code> will be returned. Next time you are using <code>Navigator.of(context)</code> or <code>Scaffold.of(context)</code> remember these are just helper method that use <code>context.findAncestorWidgetOfExactType</code> to find the nearest <code>NavigatorState</code> or <code>ScaffoldState</code> respectively.</p><p>One thing to be careful while using BuildContext is that we must always verify the context that we are using in the method is the same context that is needed. For example, using <code>Theme.of(context)</code> looks for nearest Theme. If a nearest widget <strong>X</strong> has a Theme in it&#x27;s returned widget tree and it&#x27;s calling Theme.of passing it&#x27;s on context, then the Theme that is found will not be the Theme present in the build method but rather a Theme that was an ancestor to the widget <strong>X</strong>. That is why we could use a <code>Builder</code> widget and it&#x27;s context as the context received there is the context of <code>Builder</code> hence we can get the Theme that is ancestor to Builder but is in the same widget <strong>X</strong>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="conclusion"></a>Conclusion<a aria-hidden="true" tabindex="-1" class="hash-link" href="#conclusion" title="Direct link to heading">#</a></h2><p>With this I hope you understand what BuildContext is and how crucial it is in order to understand how Flutter works. This deepens our knowledge of the framework which helps us to build robust applications confidently. </p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/flutter">flutter</a></div></footer></article><div><a href="https://github.com/lohanidamodar/dlohani.com.np/edit/master/website/blog/blog/2021-12-15-decoding-flutter-build-context.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/intro-to-linux-command-line"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Introduction to Linux Command Line Â»</div></a></div></nav></div></div><div class="col col--2"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#widget-tree" class="table-of-contents__link">Widget Tree</a></li><li><a href="#buildcontext" class="table-of-contents__link">BuildContext</a></li><li><a href="#conclusion" class="table-of-contents__link">Conclusion</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Socials</h4><ul class="footer__items"><li class="footer__item"><a href="https://youtube.com/c/reactbits" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube</a></li><li class="footer__item"><a href="https://github.com/lohanidamodar" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li><li class="footer__item"><a href="https://twitter.com/lohanidamodar" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/projects">Projects</a></li><li class="footer__item"><a class="footer__link-item" href="/contact">Contact</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2021 Damodar Lohani</div></div></div></footer></div>
<script src="/styles.c6487bce.js"></script>
<script src="/runtime~main.f2f68536.js"></script>
<script src="/main.364704fe.js"></script>
<script src="/common.44bbcb76.js"></script>
<script src="/55.41bd41e7.js"></script>
<script src="/83f3d26f.0fc53958.js"></script>
</body>
</html>