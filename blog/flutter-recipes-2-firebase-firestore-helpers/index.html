<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.65">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NR1FQ09LP2"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NR1FQ09LP2",{anonymize_ip:!0})</script><title data-react-helmet="true">Flutter Recipes 2 - Firebase Firestore Helpers | Damodar Lohani</title><meta data-react-helmet="true" property="og:title" content="Flutter Recipes 2 - Firebase Firestore Helpers | Damodar Lohani"><meta data-react-helmet="true" name="description" content="I have built quite a few apps with Flutter and Firebase. And, for most of those projects I used Firestore as the database. So, I had to perform all sorts of query, pagination, mapping Firestore returned Maps to data models. So over that period of time, I have created a simplified, generalized helper class with various methods that help me work with firestore database. That is what I am publishing here. Hope it will be useful for those using firestore in their database."><meta data-react-helmet="true" property="og:description" content="I have built quite a few apps with Flutter and Firebase. And, for most of those projects I used Firestore as the database. So, I had to perform all sorts of query, pagination, mapping Firestore returned Maps to data models. So over that period of time, I have created a simplified, generalized helper class with various methods that help me work with firestore database. That is what I am publishing here. Hope it will be useful for those using firestore in their database."><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/img/logo.svg"><link rel="stylesheet" href="/styles.46ed3ea3.css">
<link rel="preload" href="/styles.421e834f.js" as="script">
<link rel="preload" href="/runtime~main.2572ae52.js" as="script">
<link rel="preload" href="/main.8340d3b3.js" as="script">
<link rel="preload" href="/common.9cda2f45.js" as="script">
<link rel="preload" href="/51.00b8157c.js" as="script">
<link rel="preload" href="/3f92b3e4.44dd2a92.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top navbarHideable_3046"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Damodar Lohani"><strong class="navbar__title">Damodar Lohani</strong></a><a class="navbar__item navbar__link" href="/projects">Projects</a><a class="navbar__item navbar__link" href="/talks">Talks</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/contact">Contact</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/lohanidamodar" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Damodar Lohani"><strong class="navbar__title">Damodar Lohani</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/projects">Projects</a></li><li class="menu__list-item"><a class="menu__link" href="/talks">Talks</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/contact">Contact</a></li><li class="menu__list-item"><a href="https://github.com/lohanidamodar" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository"></a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--8 col--offset-2"><article><header><h1 class="margin-bottom--sm blogPostTitle_1mse">Flutter Recipes 2 - Firebase Firestore Helpers</h1><div class="margin-vert--md"><time datetime="2020-10-24T00:00:00.000Z" class="blogPostDate_3bQP">October 24, 2020  Â· 9 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/lohanidamodar" target="_blank" rel="noreferrer noopener"><img src="https://avatars1.githubusercontent.com/u/6360216?s=460&amp;u=ccf757cc3aece5b674460c4909b4a77e1d5b6a19&amp;v=4" alt="Damodar Lohani"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/lohanidamodar" target="_blank" rel="noreferrer noopener">Damodar Lohani</a></h4><small class="avatar__subtitle">Web and Mobile Developer</small></div></div></header><section class="markdown"><p>I have built quite a few apps with Flutter and Firebase. And, for most of those projects I used Firestore as the database. So, I had to perform all sorts of query, pagination, mapping Firestore returned Maps to data models. So over that period of time, I have created a simplified, generalized helper class with various methods that help me work with firestore database. That is what I am publishing here. Hope it will be useful for those using firestore in their database.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="the-source-code"></a>The Source Code<a aria-hidden="true" tabindex="-1" class="hash-link" href="#the-source-code" title="Direct link to heading">#</a></h2><p>This class has the most commonly used methods on firestore. It can get list of items from collection, single item, remove item, add item. It provides list and single item both as a future and stream. It also provides methods for easier query and simple paginations. It uses generic type so that, we can use it to convert firestore map to the required data model we want. This class is available as a part of <code>firebase_helpers</code> package.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-dart codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// The base database service class that you can instiantiate or extend</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">///</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// ```dart</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// DatabaseService&lt;Note&gt; noteDBs = DatabaseService&lt;Note&gt;(&quot;notes&quot;,fromDS: (id,data) =&gt; Note.fromDS(id,data), toMap: (note)=&gt;note.toMap());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// noteDBs.getQueryList()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">///   .then((List&lt;Note&gt; notes)=&gt;print(notes));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// ```</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">///</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class DatabaseService&lt;T&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// path of the collection to use as base path for all the operations</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  String collection;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final FirebaseFirestore _db = FirebaseFirestore.instance;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ///</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Function to convert the firestore [DocumentSnapshot] into the model class [T]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// provides [id] and [Map&lt;String,dynamic&gt; data] and must return [T] object.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ///</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final T Function(String, Map&lt;String, dynamic&gt;) fromDS;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ///</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ///Function to convert object [T] to [Map&lt;String,dynamic&gt;], receives instance of [T],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ///and should always return [Map&lt;String,dynamic&gt;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ///</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final Map&lt;String, dynamic&gt; Function(T) toMap;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Create instance of Database service</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// [collection] path is required</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// [fromDS] is required to get document snapshot as object [T]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ///</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  DatabaseService(this.collection, {this.fromDS, this.toMap});</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Returns instance of FirebaseFirestore</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  FirebaseFirestore get db =&gt; _db;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Get a single document of [id] from the [collection]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Returns null if the document does not exist</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Future&lt;T&gt; getSingle(String id) async {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var snap = await _db.collection(collection).doc(id).get();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!snap.exists) return null;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return fromDS(snap.id, snap.data());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Returns a single document of [id] from [collection]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// as stream so that updates can be listened</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Stream&lt;T&gt; streamSingle(String id) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return _db</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        .collection(collection)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        .doc(id)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        .snapshots()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        .map((snap) =&gt; snap.exists ? fromDS(snap.id, snap.data()) : null);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Returns list of all the documents from [collection]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// as a stream so that changes can be listened</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Stream&lt;List&lt;T&gt;&gt; streamList() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var ref = _db.collection(collection);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return ref.snapshots().map(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        (list) =&gt; list.docs.map((doc) =&gt; fromDS(doc.id, doc.data())).toList());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Returns the list of documents from [collection], in the order provided in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// [orderBy] and matches the [args] supplied.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// use [startAfter], [startAt], [endAt], [endBefore] to perform cursor based queries</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// and pagination of data</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Future&lt;List&lt;T&gt;&gt; getQueryList({</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    List&lt;OrderBy&gt; orderBy,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    List&lt;QueryArgs&gt; args,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    int limit,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    dynamic startAfter,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    dynamic startAt,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    dynamic endAt,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    dynamic endBefore,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }) async {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CollectionReference collref = _db.collection(collection);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Query ref;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (args != null) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      for (final arg in args) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (arg is QueryArgsV2) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          if (ref == null)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            ref = collref.where(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              arg.key,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isEqualTo: arg.isEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isGreaterThan: arg.isGreaterThan,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isGreaterThanOrEqualTo: arg.isGreaterThanOrEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isLessThan: arg.isLessThan,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isLessThanOrEqualTo: arg.isLessThanOrEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isNull: arg.isNull,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              arrayContains: arg.arrayContains,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              arrayContainsAny: arg.arrayContainsAny,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              whereIn: arg.whereIn,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            ref = ref.where(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              arg.key,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isEqualTo: arg.isEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isGreaterThan: arg.isGreaterThan,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isGreaterThanOrEqualTo: arg.isGreaterThanOrEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isLessThan: arg.isLessThan,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isLessThanOrEqualTo: arg.isLessThanOrEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isNull: arg.isNull,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              arrayContains: arg.arrayContains,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              arrayContainsAny: arg.arrayContainsAny,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              whereIn: arg.whereIn,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          ;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        } else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          if (ref == null)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            ref = collref.where(arg.key, isEqualTo: arg.value);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            ref = ref.where(arg.key, isEqualTo: arg.value);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (orderBy != null) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      orderBy.forEach((order) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (ref == null)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          ref = collref.orderBy(order.field, descending: order.descending);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          ref = ref.orderBy(order.field, descending: order.descending);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (limit != null) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      if (ref == null)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ref = collref.limit(limit);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ref = ref.limit(limit);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (startAfter != null &amp;&amp; orderBy != null) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ref = ref.startAfter([startAfter]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (startAt != null &amp;&amp; orderBy != null) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ref = ref.startAt([startAt]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (endAt != null &amp;&amp; orderBy != null) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ref = ref.endAt([endAt]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (endBefore != null &amp;&amp; orderBy != null) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ref = ref.endBefore([endBefore]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    QuerySnapshot query;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (ref != null)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      query = await ref.get();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      query = await collref.get();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return query.docs.map((doc) =&gt; fromDS(doc.id, doc.data())).toList();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Returns the list of documents from [collection], in the order provided in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// [orderBy] and matches the [args] supplied as a stream so that changes can be</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// listened.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Use [startAfter], [startAt], [endAt], [endBefore] to perform cursor based</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// queries and pagination of data</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Stream&lt;List&lt;T&gt;&gt; streamQueryList({</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    List&lt;OrderBy&gt; orderBy,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    List&lt;QueryArgs&gt; args,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    int limit,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    dynamic startAfter,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    dynamic startAt,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    dynamic endBefore,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    dynamic endAt,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    CollectionReference collref = _db.collection(collection);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Query ref;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (orderBy != null) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      orderBy.forEach((order) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (ref == null)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          ref = collref.orderBy(order.field, descending: order.descending);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          ref = ref.orderBy(order.field, descending: order.descending);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (args != null) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      for (final arg in args) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if (arg is QueryArgsV2) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          if (ref == null)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            ref = collref.where(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              arg.key,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isEqualTo: arg.isEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isGreaterThan: arg.isGreaterThan,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isGreaterThanOrEqualTo: arg.isGreaterThanOrEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isLessThan: arg.isLessThan,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isLessThanOrEqualTo: arg.isLessThanOrEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isNull: arg.isNull,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              arrayContains: arg.arrayContains,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              arrayContainsAny: arg.arrayContainsAny,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              whereIn: arg.whereIn,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            ref = ref.where(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              arg.key,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isEqualTo: arg.isEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isGreaterThan: arg.isGreaterThan,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isGreaterThanOrEqualTo: arg.isGreaterThanOrEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isLessThan: arg.isLessThan,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isLessThanOrEqualTo: arg.isLessThanOrEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              isNull: arg.isNull,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              arrayContains: arg.arrayContains,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              arrayContainsAny: arg.arrayContainsAny,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              whereIn: arg.whereIn,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        } else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          if (ref == null)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            ref = collref.where(arg.key, isEqualTo: arg.value);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            ref = ref.where(arg.key, isEqualTo: arg.value);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (limit != null) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      if (ref == null)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ref = collref.limit(limit);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ref = ref.limit(limit);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (startAfter != null &amp;&amp; orderBy != null) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ref = ref.startAfter([startAfter]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (startAt != null &amp;&amp; orderBy != null) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ref = ref.startAt([startAt]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (endAt != null &amp;&amp; orderBy != null) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ref = ref.endAt([endAt]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (endBefore != null &amp;&amp; orderBy != null) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ref = ref.endBefore([endBefore]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (ref != null)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      return ref.snapshots().map((snap) =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          snap.docs.map((doc) =&gt; fromDS(doc.id, doc.data())).toList());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      return collref.snapshots().map((snap) =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          snap.docs.map((doc) =&gt; fromDS(doc.id, doc.data())).toList());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Returns the list of documents from [from] date to [to] date matched by [field]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// is ordered by the [field] provided.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// additional [args] can be supplied to perform specific query.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Future&lt;List&lt;T&gt;&gt; getListFromTo(String field, DateTime from, DateTime to,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      {List&lt;QueryArgs&gt; args = const []}) async {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var ref = _db.collection(collection).orderBy(field);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    for (final arg in args) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      if (arg is QueryArgsV2) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ref = ref.where(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          arg.key,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          isEqualTo: arg.isEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          isGreaterThan: arg.isGreaterThan,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          isGreaterThanOrEqualTo: arg.isGreaterThanOrEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          isLessThan: arg.isLessThan,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          isLessThanOrEqualTo: arg.isLessThanOrEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          isNull: arg.isNull,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          arrayContains: arg.arrayContains,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          arrayContainsAny: arg.arrayContainsAny,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          whereIn: arg.whereIn,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      } else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ref = ref.where(arg.key, isEqualTo: arg.value);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    QuerySnapshot query = await ref.startAt([from]).endAt([to]).get();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return query.docs.map((doc) =&gt; fromDS(doc.id, doc.data())).toList();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Returns the list of documents from [from] date to [to] date matched by [field] from [collection]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// as a stream so that changes can be listened and is ordered by the [field] provided.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// additional [args] can be supplied to perform specific query.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Stream&lt;List&lt;T&gt;&gt; streamListFromTo(String field, DateTime from, DateTime to,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      {List&lt;QueryArgs&gt; args = const []}) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var ref = _db.collection(collection).orderBy(field, descending: true);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    for (final arg in args) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      if (arg is QueryArgsV2) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ref = ref.where(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          arg.key,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          isEqualTo: arg.isEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          isGreaterThan: arg.isGreaterThan,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          isGreaterThanOrEqualTo: arg.isGreaterThanOrEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          isLessThan: arg.isLessThan,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          isLessThanOrEqualTo: arg.isLessThanOrEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          isNull: arg.isNull,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          arrayContains: arg.arrayContains,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          arrayContainsAny: arg.arrayContainsAny,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          whereIn: arg.whereIn,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      } else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ref = ref.where(arg.key, isEqualTo: arg.value);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var query = ref.startAfter([to]).endAt([from]).snapshots();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return query.map(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        (snap) =&gt; snap.docs.map((doc) =&gt; fromDS(doc.id, doc.data())).toList());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Creates new document based on the provided [item] and [id] in the [collection]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// If [id] is null, [id] will be auto generated by firestore</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ///</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @Deprecated(&quot;Use create(Map&lt;String,dynamic&gt; data, {String id}) instead.&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Future&lt;dynamic&gt; createItem(T item, {String id}) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (id != null) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      return _db.collection(collection).doc(id).set(toMap(item));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    } else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      return _db.collection(collection).add(toMap(item));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Creates new document based on the provided [data] and [id]  in the [collection]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// If [id] is null, [id] will be auto generated by firestore</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ///</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Future&lt;dynamic&gt; create(Map&lt;String, dynamic&gt; data, {String id}) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (id != null) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      return _db.collection(collection).doc(id).set(data);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    } else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      return _db.collection(collection).add(data);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ///</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Updates the document with [id] with the provided [data] to the [collection]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ///</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Future&lt;void&gt; updateData(String id, Map&lt;String, dynamic&gt; data) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return _db.collection(collection).doc(id).update(data);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Removes item with [id] from [collection]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Future&lt;void&gt; removeItem(String id) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return _db.collection(collection).doc(id).delete();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// Supply query to query the data based on [key] field with [value]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// Always performs `isEqualTo` query</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@Deprecated(&quot;Use QueryArgsV2 instead&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class QueryArgs {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final dynamic key;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final dynamic value;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  QueryArgs(this.key, this.value);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// Supply query to query the collection based on [key] field and the</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// values supplied to various arguments</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// Please refer to firestore documentation for understanding</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// various operators of the query</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class QueryArgsV2 extends QueryArgs {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Field to match</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final dynamic key;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// performs equality == check</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final dynamic isEqualTo;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// performs less than &lt; check</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final dynamic isLessThan;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// performs less than or equal to &lt;= check</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final dynamic isLessThanOrEqualTo;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// performs greater than or equal to &gt;= check</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final dynamic isGreaterThanOrEqualTo;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// performs greater than &gt; check</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final dynamic isGreaterThan;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// performs array contains check</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final dynamic arrayContains;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// performs array contains any check</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final List&lt;dynamic&gt; arrayContainsAny;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// performs where in check</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final List&lt;dynamic&gt; whereIn;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// performs if is null check</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final bool isNull;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Create instance of QueryArgsV2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  QueryArgsV2(this.key,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      {this.isEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      this.isLessThan,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      this.isLessThanOrEqualTo,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      this.isGreaterThan,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      this.arrayContains,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      this.arrayContainsAny,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      this.whereIn,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      this.isNull,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      this.isGreaterThanOrEqualTo})</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      : super(key, isEqualTo);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// Provide ordering option to queries</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class OrderBy {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Field to order by</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final String field;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Whether the order should be descending, default is false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  final bool descending;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /// Creates instance of OrderBy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  OrderBy(this.field, {this.descending = false});</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><p>Below I will show how to use this package to get a list of <code>Note</code> items from <code>notes</code> collection.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="adding-dependency-and-importing"></a>Adding Dependency and importing<a aria-hidden="true" tabindex="-1" class="hash-link" href="#adding-dependency-and-importing" title="Direct link to heading">#</a></h2><p>First add it&#x27;s dependency to the <code>pubspec.yaml</code> file.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-yaml codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">dependencies</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">firebase_helpers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> latest</span></div></div></div></div></div><p>Then where you want to use it&#x27;s methods, you can import it</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-dart codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">import &#x27;package:firebase_helpers/firebase_helpers&#x27;;</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="create-a-model"></a>Create a model<a aria-hidden="true" tabindex="-1" class="hash-link" href="#create-a-model" title="Direct link to heading">#</a></h2><p>We create a notes item model for our data</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-dart codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">class Note{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">final String title;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">final String id;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">final String description;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">final DateTime createdAt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">final String userId;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Note({this.title, this.id, this.description, this.createdAt, this.userId});</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Note.fromDS(String id, Map&lt;String,dynamic&gt; data):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    id=id,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    title=data[&#x27;title&#x27;],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    description=data[&#x27;description&#x27;],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    userId=data[&#x27;user_id&#x27;],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    createdAt=data[&#x27;created_at&#x27;]?.toDate();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Map&lt;String,dynamic&gt; toMap() =&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;title&quot;:title,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;description&quot;:description,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;created_at&quot;: createdAt,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;user_id&quot;: userId,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="instiantiate-database-service-with-specific-type"></a>Instiantiate database service with specific type<a aria-hidden="true" tabindex="-1" class="hash-link" href="#instiantiate-database-service-with-specific-type" title="Direct link to heading">#</a></h2><p>We instantiate the generic class using the <code>Note</code> model as our type. Pass the collection path as <code>notes</code> and provide functions to convert from <code>DocumentSnapshot</code> to <code>note</code> and <code>note</code> to <code>Map</code></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-dart codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">DatabaseService&lt;Note&gt; notesDb = DatabaseService&lt;Note&gt;(&quot;notes&quot;,fromDS: (id,data) =&gt;  Note.fromDS(id,data), toMap:(note) =&gt; note.toMap() );</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="insert-new-item-to-firestore"></a>Insert new item to firestore<a aria-hidden="true" tabindex="-1" class="hash-link" href="#insert-new-item-to-firestore" title="Direct link to heading">#</a></h2><p>Finally we can use <code>notesDb</code> instance to work with <code>notes</code> collection in our Firestore. For example to create item</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-dart codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Note note = Note(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    title: &quot;Hello Note&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    description: &quot;This is notes description&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">notesDb.create(note.toMap()); //this function will add our note item to the firestore database </span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="github-repository"></a>Github Repository<a aria-hidden="true" tabindex="-1" class="hash-link" href="#github-repository" title="Direct link to heading">#</a></h2><p><a href="https://github.com/lohanidamodar/flutter_firebase_starter" target="_blank" rel="noopener noreferrer">https://github.com/lohanidamodar/flutter_firebase_starter</a></p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/flutter">flutter</a></div></footer></article><div><a href="https://github.com/lohanidamodar/dlohani.com.np/edit/master/website/blog/blog/2020-10-24-flutter-recipes-2.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/singleton-in-dart"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Â« Singleton Pattern in Dart</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/flutter-url-preview"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Flutter URL Preview Â»</div></a></div></nav></div></div><div class="col col--2"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-source-code" class="table-of-contents__link">The Source Code</a></li><li><a href="#adding-dependency-and-importing" class="table-of-contents__link">Adding Dependency and importing</a></li><li><a href="#create-a-model" class="table-of-contents__link">Create a model</a></li><li><a href="#instiantiate-database-service-with-specific-type" class="table-of-contents__link">Instiantiate database service with specific type</a></li><li><a href="#insert-new-item-to-firestore" class="table-of-contents__link">Insert new item to firestore</a></li><li><a href="#github-repository" class="table-of-contents__link">Github Repository</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Socials</h4><ul class="footer__items"><li class="footer__item"><a href="https://youtube.com/c/reactbits" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube</a></li><li class="footer__item"><a href="https://github.com/lohanidamodar" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li><li class="footer__item"><a href="https://twitter.com/lohanidamodar" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/projects">Projects</a></li><li class="footer__item"><a class="footer__link-item" href="/contact">Contact</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2021 Damodar Lohani</div></div></div></footer></div>
<script src="/styles.421e834f.js"></script>
<script src="/runtime~main.2572ae52.js"></script>
<script src="/main.8340d3b3.js"></script>
<script src="/common.9cda2f45.js"></script>
<script src="/51.00b8157c.js"></script>
<script src="/3f92b3e4.44dd2a92.js"></script>
</body>
</html>